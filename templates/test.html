<!DOCTYPE html>
<html>
  <head>
    <title>Test</title>
    <script>
      let timeLeft = 60 * 60; // 60 minutes in seconds (change if needed)

      function startTimer() {
        const timerEl = document.getElementById("timer");

        const interval = setInterval(() => {
          let m = Math.floor(timeLeft / 60);
          let s = timeLeft % 60;
          timerEl.innerText = m + ":" + (s < 10 ? "0" + s : s);

          if (timeLeft <= 0) {
            clearInterval(interval);
            document.getElementById("testForm").submit();
          }
          timeLeft--;
        }, 1000);
      }

      window.onload = startTimer;
      window.onbeforeunload = () => "Test is running. Are you sure?";
    </script>
  </head>
  <body>
    <h2>Test</h2>
    <h3>Time Left: <span id="timer">60:00</span></h3>

    <form id="testForm" method="post" action="/submit">
      {% for q in questions %}
      <p><b>{{ loop.index }}. {{ q.question_text }}</b></p>
      {% for opt in q.options %}
      <input type="radio" name="{{ q.question_id }}" value="{{ opt[0] }}" />
      {{ opt[0] }}. {{ opt[1] }}<br />
      {% endfor %}
      <hr />
      {% endfor %}
      <button type="submit">Submit</button>
    </form>
  </body>
</html>
